$RegPath = 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers'
$RegProperty = 'RegisterSpoolerRemoteRpcEndPoint'
$RegValue = 2

try {
    if ((Get-ItemProperty -Path $Regpath -ErrorAction SilentlyContinue | Select-Object -ExpandProperty $RegProperty) -eq $RegValue){ 
        Write-Output $true 
        "Registry key '$RegPath' with property '$RegProperty' matches '$Regvalue'"
        exit 0
    } else { 
        Write-Output $false
        "Registry key '$RegPath' with property '$RegProperty' does not match '$Regvalue'"
        exit 1
    }
} catch {
    Write-Warning "Unable to get Item Property.`n$_"
    exit 1
}